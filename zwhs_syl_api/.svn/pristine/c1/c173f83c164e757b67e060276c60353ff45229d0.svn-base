package cn.org.citycloud.zwhs.syl.controller;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Sort;
import org.springframework.data.domain.Sort.Direction;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import cn.org.citycloud.zwhs.syl.constants.ErrorCodes;
import cn.org.citycloud.zwhs.syl.entity.Store;
import cn.org.citycloud.zwhs.syl.entity.StoreGood;
import cn.org.citycloud.zwhs.syl.exception.BusinessErrorException;
import cn.org.citycloud.zwhs.syl.service.StoreGoodService;


@Controller
@RequestMapping("storegood")
public class StoreGoodController {
	
	@Autowired
	private StoreGoodService storeGoodService;
	
	
	/**
	 * 获取母婴店店铺列表
	 * 列表
	 * @return
	 */
	@RequestMapping(value = "/list", method = RequestMethod.GET)
	@ResponseBody()
	public Object getStoreGood(@RequestParam(value = "pageNo", defaultValue = "1") Integer pageNo,
	        @RequestParam(value = "pageSize", defaultValue = "10")  Integer pageSize,
	        @RequestParam(value = "gc_no", required = false)  Integer gcNo,
	        @RequestParam(value = "goods_name", required = false)  String goodsName,
	        @RequestParam(value = "store_name", required = false)  String storeName,
	        @RequestParam(value = "start_time", required = false)  String startTime,
	        @RequestParam(value = "end_time", required = false)  String endTime) throws Exception, RuntimeException {

		
		Sort sort = new Sort(Direction.DESC, "goodsId");
	    Pageable pageable = new PageRequest(pageNo - 1, pageSize, sort);
	    StoreGood storeGood = new StoreGood();
	    storeGood.setGcNo(gcNo);
	    storeGood.setGoodsName(goodsName);
	    Store store = new Store();
	    store.setCompanyName(storeName);
	    storeGood.setStore(store);;
	    
	    Page<StoreGood> list = storeGoodService.getStoreList(pageable, storeGood, startTime, endTime);
		return list;
	}
	
	/**
	 * 查看店铺详情
	 * @return
	 */
	@RequestMapping(value = "/detail", method = RequestMethod.GET)
	@ResponseBody()
	public Object detailStoreGoods(
			@RequestParam(value = "goods_id") Integer goodsId) throws Exception, RuntimeException {

		if(goodsId == null){
			
			throw new BusinessErrorException(ErrorCodes.PARAM_ERROR, "参数为空");
			
		}
		StoreGood storeGood = storeGoodService.getStoreGoodByGoodsId(goodsId);
		return storeGood;
	}
	
	
	
}
